(function(e){function t(t){for(var r,s,i=t[0],l=t[1],c=t[2],d=0,m=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(n,s)&&n[s]&&m.push(n[s][0]),n[s]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);u&&u(t);while(m.length)m.shift()();return o.push.apply(o,c||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],r=!0,i=1;i<a.length;i++){var l=a[i];0!==n[l]&&(r=!1)}r&&(o.splice(t--,1),e=s(s.s=a[0]))}return e}var r={},n={app:0},o=[];function s(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=r,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)s.d(a,r,function(t){return e[t]}.bind(null,r));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],l=i.push.bind(i);i.push=t,i=i.slice();for(var c=0;c<i.length;c++)t(i[c]);var u=l;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-main",[a("router-view")],1)],1)},o=[],s={name:"App",data:function(){return{}}},i=s,l=a("2877"),c=a("6544"),u=a.n(c),d=a("7496"),m=a("f6c4"),f=Object(l["a"])(i,n,o,!1,null,null,null),p=f.exports;u()(f,{VApp:d["a"],VMain:m["a"]});var v=a("8c4f"),g=(a("d3b7"),a("2f62")),h=a("bc3a"),b=a.n(h);r["a"].use(g["a"]);var w=new g["a"].Store({state:{status:"",token:localStorage.getItem("token")||"",user:localStorage.getItem("username")||{},uploading:!1},mutations:{auth_request:function(e){e.status="loading"},auth_success:function(e,t){e.status="success",e.user=t.username,e.token=t.token},auth_error:function(e){e.status="error"},logout:function(e){e.status="",e.token=""},start_upload:function(e){e.uploading=!0},finish_upload:function(e){e.uploading=!1}},actions:{login:function(e,t){var a=e.commit;return new Promise((function(e,r){a("auth_request"),b()({url:"/login",data:t,method:"POST"}).then((function(t){var r={token:t.data.token,username:t.data.username};localStorage.setItem("token",r.token),localStorage.setItem("username",r.username),b.a.defaults.headers.common["Authorization"]="bearer "+r.token,a("auth_success",r),e(t)})).catch((function(e){a("auth_error"),localStorage.removeItem("token"),r(e)}))}))},register:function(e,t){var a=e.commit;return new Promise((function(e,r){a("auth_request"),b()({url:"/users",data:t,method:"POST"}).then((function(t){var r={token:t.data.token,username:t.data.username};localStorage.setItem("token",r.token),localStorage.setItem("username",r.username),b.a.defaults.headers.common["Authorization"]="bearer "+r.token,a("auth_success",r),e(t)})).catch((function(e){a("auth_error",e),localStorage.removeItem("token"),r(e)}))}))},logout:function(e){var t=e.commit;return new Promise((function(e){t("logout"),localStorage.removeItem("token"),localStorage.removeItem("username"),delete b.a.defaults.headers.common["Authorization"],e()}))},insertImage:function(e,t){var a=e.commit;return new Promise((function(e,r){a("start_upload"),b()({url:"/images",data:t,method:"POST"}).then((function(t){a("finish_upload"),e(t)})).catch((function(e){return r(e)}))}))}},getters:{isLoggedIn:function(e){return!!e.token},authStatus:function(e){return e.status},username:function(e){return e.user}}}),k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Gallary")},x=[],_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("v-app-bar",{attrs:{color:"purple accent-4",dark:""}},[a("v-toolbar-title",[e._v("Welcome "+e._s(e.username))]),a("v-spacer"),a("v-text-field",{staticClass:"pt-5",attrs:{label:"Search tag here","prepend-icon":"mdi-magnify","single-line":""},on:{keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getTaggedImages(t)}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}),a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,n=t.attrs;return[a("v-btn",e._g(e._b({attrs:{icon:""},on:{click:function(t){t.stopPropagation(),e.dialog=!0}}},"v-btn",n,!1),r),[a("v-icon",[e._v("mdi-plus")])],1)]}}])},[a("span",[e._v("Add Image")])]),a("v-tooltip",{attrs:{bottom:""},scopedSlots:e._u([{key:"activator",fn:function(t){var r=t.on,n=t.attrs;return[a("v-btn",e._g(e._b({attrs:{icon:""},on:{click:e.logout}},"v-btn",n,!1),r),[a("v-icon",[e._v("mdi-logout")])],1)]}}])},[a("span",[e._v("Logout")])])],1),a("v-container",[a("v-row",e._l(e.images.length,(function(t){return a("v-col",{key:t-1,staticClass:"d-flex child-flex",attrs:{cols:"4"},on:{click:function(a){return e.selectImage(t-1)}}},[a("v-hover",{scopedSlots:e._u([{key:"default",fn:function(r){var n=r.hover;return[a("v-card",{staticClass:"justify-center align-center",attrs:{elevation:n?10:2}},[a("v-img",{staticClass:"grey lighten-2",attrs:{src:e.images[t-1].path,contain:"",height:"200",width:"400"},scopedSlots:e._u([{key:"placeholder",fn:function(){return[a("v-row",{staticClass:"fill-height ma-0",attrs:{align:"center",justify:"center"}},[a("v-progress-circular",{attrs:{indeterminate:"",color:"grey lighten-5"}})],1)]},proxy:!0}],null,!0)})],1)]}}],null,!0)})],1)})),1)],1),a("v-dialog",{attrs:{persistent:"","max-width":"340"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"headline"},[e._v(" Upload New Image ")]),a("v-card-text",[a("v-form",{ref:"insertForm",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{rules:[e.rules.required],label:"File Name",required:""},model:{value:e.fileName,callback:function(t){e.fileName=t},expression:"fileName"}})],1),a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{label:"tags (seperated by comma)",rules:[e.rules.required],required:""},model:{value:e.tags,callback:function(t){e.tags=t},expression:"tags"}})],1),a("v-col",{attrs:{cols:"12"}},[a("v-file-input",{attrs:{accept:"image/*",label:"File input",rules:[e.rules.required]},model:{value:e.file,callback:function(t){e.file=t},expression:"file"}})],1)],1)],1)],1),a("v-card-actions",[a("v-spacer"),a("v-btn",{attrs:{color:"red darken-1",text:""},on:{click:e.reset}},[e._v(" Cancel ")]),a("v-btn",{attrs:{color:"green darken-1",text:"",disabled:!e.valid},on:{click:e.insertImage}},[e._v(" Upload ")])],1)],1)],1),e.image?a("v-dialog",{attrs:{"max-width":"800"},model:{value:e.dialog2,callback:function(t){e.dialog2=t},expression:"dialog2"}},[a("v-card",{staticClass:"mx-auto",attrs:{"max-width":"800"}},[a("v-img",{attrs:{contain:"",src:e.image.path}}),a("v-card-title",{staticClass:"justify-center"},[e._v(" "+e._s(e.image.name)+" ")]),a("v-card-subtitle",{staticClass:"text-center"},e._l(e.image.tags.length,(function(t){return a("v-chip",{key:t,staticClass:"ma-2",attrs:{color:"purple",outlined:""}},[e._v(" "+e._s(e.image.tags[t-1])+" ")])})),1),a("v-card-actions",[a("v-btn",{attrs:{dark:"",color:"purple accent-4"},on:{click:function(t){t.stopPropagation(),e.dialog2=!1}}},[e._v(" Close ")]),a("v-spacer"),a("v-btn",{attrs:{dark:"",color:"red accent-4"},on:{click:function(t){return e.deleteImage()}}},[e._v(" Delete ")])],1)],1)],1):e._e()],1)},y=[],V=(a("159b"),a("d81d"),a("ac1f"),a("1276"),a("498a"),a("841c"),a("4de4"),{name:"Gallary",mounted:function(){this.getImages()},computed:{username:function(){return this.$store.getters.username}},methods:{getImages:function(){var e=this;this.$http.get("/images").then((function(t){e.images=[],t.data.forEach((function(t){e.images.push(t)}))}))},logout:function(){var e=this;this.$store.dispatch("logout").then((function(){return e.$router.push("/login")})).catch((function(e){return console.log(e)}))},insertImage:function(){var e=this;if(this.$refs.insertForm.validate()){var t=this.tags.split(",").map((function(e){return e.trim()})),a=this.fileName,r=this.file,n=new FormData;n.append("fileName",a),n.append("tags",JSON.stringify(t)),n.append("file",r),this.$store.dispatch("insertImage",n).then((function(){e.getImages()})).catch((function(e){return console.log(e)})),this.reset()}},reset:function(){this.dialog=!1,this.$refs.insertForm.reset(),this.$refs.insertForm.resetValidation()},getTaggedImages:function(){var e=this;if(""==this.search)this.getImages();else{var t={tag:this.search};this.$http.post("/images/tag",t).then((function(t){e.images=[],t.data.forEach((function(t){e.images.push(t)}))}))}},selectImage:function(e){var t=this;this.$http.get("/images/"+this.images[e].image_id).then((function(e){t.image=e.data,t.dialog2=!0})).catch((function(e){return console.log(e)}))},deleteImage:function(){var e=this;this.$http.delete("/images/"+this.image.image_id).then((function(){e.images=e.images.filter((function(t){return t.image_id!=e.image.image_id}))})).catch((function(e){console.log(e)})),this.dialog2=!1}},data:function(){return{search:"",images:[],image:null,length:0,dialog:!1,dialog2:!1,tags:"",fileName:"",file:null,valid:!0,rules:{required:function(e){return!!e||"Required."}}}}}),I=V,C=a("40dc"),S=a("8336"),P=a("b0af"),$=a("99d9"),q=a("cc20"),O=a("62ad"),T=a("a523"),E=a("169a"),F=a("23a7"),j=a("4bd4"),U=a("ce87"),A=a("132d"),R=a("adda"),N=a("490a"),M=a("0fd9"),z=a("2fa4"),L=a("8654"),D=a("2a7f"),B=a("3a2f"),G=Object(l["a"])(I,_,y,!1,null,null,null),H=G.exports;u()(G,{VAppBar:C["a"],VBtn:S["a"],VCard:P["a"],VCardActions:$["a"],VCardSubtitle:$["b"],VCardText:$["c"],VCardTitle:$["d"],VChip:q["a"],VCol:O["a"],VContainer:T["a"],VDialog:E["a"],VFileInput:F["a"],VForm:j["a"],VHover:U["a"],VIcon:A["a"],VImg:R["a"],VProgressCircular:N["a"],VRow:M["a"],VSpacer:z["a"],VTextField:L["a"],VToolbarTitle:D["a"],VTooltip:B["a"]});var J={name:"Home",components:{Gallary:H}},W=J,K=Object(l["a"])(W,k,x,!1,null,null,null),Q=K.exports,X=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-dialog",{attrs:{persistent:"","max-width":"600px","min-width":"360px"},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[a("div",[a("v-tabs",{attrs:{"show-arrows":"","background-color":"purple accent-4","icons-and-text":"",dark:"",grow:""},model:{value:e.tab,callback:function(t){e.tab=t},expression:"tab"}},[a("v-tabs-slider",{attrs:{color:"purple darken-4"}}),e._l(e.tabs,(function(t){return a("v-tab",{key:e.tabs[t],on:{click:e.reset}},[a("v-icon",{attrs:{large:""}},[e._v(e._s(t.icon))]),a("div",{staticClass:"caption py-1"},[e._v(e._s(t.name))])],1)})),a("v-tab-item",[a("v-card",{staticClass:"px-4"},[a("v-card-text",[a("v-alert",{attrs:{type:"error"},model:{value:e.showError,callback:function(t){e.showError=t},expression:"showError"}},[e._v(" "+e._s(e.error)+" ")]),a("v-form",{ref:"loginForm",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-row",[a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{rules:e.loginUsernameRules,label:"Username",required:""},model:{value:e.loginUsername,callback:function(t){e.loginUsername=t},expression:"loginUsername"}})],1),a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{"append-icon":e.show1?"eye":"eye-off",rules:[e.rules.required,e.rules.min],type:e.show1?"text":"password",name:"input-10-1",label:"Password",hint:"At least 8 characters",counter:""},on:{"click:append":function(t){e.show1=!e.show1}},model:{value:e.loginPassword,callback:function(t){e.loginPassword=t},expression:"loginPassword"}})],1),a("v-col",{staticClass:"d-flex",attrs:{cols:"12",sm:"6",xsm:"12"}}),a("v-spacer"),a("v-col",{staticClass:"d-flex",attrs:{cols:"12",sm:"3",xsm:"12","align-end":""}},[a("v-btn",{attrs:{"x-large":"",block:"",disabled:!e.valid,color:"purple",dark:""},on:{click:e.validate}},[e._v(" Login ")])],1)],1)],1)],1)],1)],1),a("v-tab-item",[a("v-card",{staticClass:"px-4"},[a("v-card-text",[a("v-alert",{attrs:{type:"error"},model:{value:e.showError,callback:function(t){e.showError=t},expression:"showError"}},[e._v(" "+e._s(e.error)+" ")]),a("v-form",{ref:"registerForm",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[a("v-row",[a("v-col",[a("v-text-field",{attrs:{rules:e.usernameRules,label:"Username",required:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{"append-icon":e.show1?"mdi-eye":"mdi-eye-off",rules:[e.rules.required,e.rules.min],type:e.show1?"text":"password",name:"input-10-1",label:"Password",hint:"At least 8 characters",counter:""},on:{"click:append":function(t){e.show1=!e.show1}},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),a("v-col",{attrs:{cols:"12"}},[a("v-text-field",{attrs:{block:"","append-icon":e.show1?"mdi-eye":"mdi-eye-off",rules:[e.rules.required,e.passwordMatch],type:e.show1?"text":"password",name:"input-10-1",label:"Confirm Password",counter:""},on:{"click:append":function(t){e.show1=!e.show1}},model:{value:e.verify,callback:function(t){e.verify=t},expression:"verify"}})],1),a("v-spacer"),a("v-col",{staticClass:"d-flex ml-auto",attrs:{cols:"12",sm:"3",xsm:"12"}},[a("v-btn",{attrs:{"x-large":"",block:"",disabled:!e.valid,color:"purple",dark:""},on:{click:e.validate}},[e._v("Register")])],1)],1)],1)],1)],1)],1)],2)],1)])},Y=[],Z={name:"Login",computed:{passwordMatch:function(){var e=this;return function(){return e.password===e.verify||"Password must match"}}},methods:{validate:function(){var e=this;if(this.$refs.loginForm.validate()){var t=this.loginUsername,a=this.loginPassword;this.$store.dispatch("login",{username:t,password:a}).then((function(){return e.$router.push("/")})).catch((function(t){e.showError=!0,e.error=t.response.data.error}))}else if(this.$refs.registerForm.validate()){var r=this.username,n=this.password;this.$store.dispatch("register",{username:r,password:n}).then((function(){return e.$router.push("/")})).catch((function(t){e.showError=!0,e.error=t.response.data.error}))}},reset:function(){this.showError=!1,this.$refs.registerForm.reset(),this.$refs.loginForm.reset()}},data:function(){return{dialog:!0,showError:!1,error:"",tab:0,tabs:[{name:"Login",icon:"mdi-account"},{name:"Register",icon:"mdi-account-outline"}],valid:!0,username:"",password:"",verify:"",loginPassword:"",loginUsername:"",loginUsernameRules:[function(e){return!!e||"Required"},function(e){return e.length>=4||"Username must be more than 4 characters"},function(e){return e.length<50||"Username must be less than 50 characters"}],usernameRules:[function(e){return!!e||"Required"},function(e){return e.length>=4||"Username must be more than 4 characters"},function(e){return e.length<50||"Username must be less than 50 characters"}],show1:!1,rules:{required:function(e){return!!e||"Required."},min:function(e){return e&&e.length>=8||"Min 8 characters"}}}}},ee=Z,te=a("0798"),ae=a("71a3"),re=a("c671"),ne=a("fe57"),oe=a("9a96"),se=Object(l["a"])(ee,X,Y,!1,null,null,null),ie=se.exports;u()(se,{VAlert:te["a"],VBtn:S["a"],VCard:P["a"],VCardText:$["c"],VCol:O["a"],VDialog:E["a"],VForm:j["a"],VIcon:A["a"],VRow:M["a"],VSpacer:z["a"],VTab:ae["a"],VTabItem:re["a"],VTabs:ne["a"],VTabsSlider:oe["a"],VTextField:L["a"]}),r["a"].use(v["a"]);var le=[{path:"/",name:"Home",component:Q,meta:{requiresAuth:!0}},{path:"/login",name:"login",component:ie}],ce=new v["a"]({mode:"history",base:"/",routes:le});ce.beforeEach((function(e,t,a){if(e.matched.some((function(e){return e.meta.requiresAuth}))){if(w.getters.isLoggedIn)return void a();a("/login")}else a()}));var ue=ce,de=a("f309");r["a"].use(de["a"]);var me=new de["a"]({});r["a"].prototype.$http=b.a;var fe=localStorage.getItem("token");fe&&(r["a"].prototype.$http.defaults.headers.common["Authorization"]="bearer "+fe),r["a"].config.productionTip=!1,new r["a"]({router:ue,store:w,vuetify:me,render:function(e){return e(p)}}).$mount("#app")}});
//# sourceMappingURL=app.500ac281.js.map